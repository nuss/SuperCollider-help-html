<!doctype html><html lang='en'><head><title>PopUpTreeMenu | SuperCollider 3.13.0 Help</title>
<link rel='stylesheet' href='./../scdoc.css' type='text/css' />
<link rel='stylesheet' href='./../codemirror.css' type='text/css' />
<link rel='stylesheet' href='./../editor.css' type='text/css' />
<link rel='stylesheet' href='./../frontend.css' type='text/css' />
<link rel='stylesheet' href='./../custom.css' type='text/css' />
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
<script src='./../lib/jquery.min.js'></script>
<script src='./../lib/codemirror-5.39.2.min.js' type='text/javascript'></script>
<script src='./../lib/codemirror-addon-simple-5.39.2.min.js' type='text/javascript'></script>
<script>
var helpRoot = './..';
var scdoc_title = 'PopUpTreeMenu';
var scdoc_sc_version = '3.13.0';
</script>
<script src='./../scdoc.js' type='text/javascript'></script>
<script src='./../docmap.js' type='text/javascript'></script>
<script src='qrc:///qtwebchannel/qwebchannel.js' type='text/javascript'></script>
</head>
<body onload='fixTOC()'>
<div id='toc'>
<div id='toctitle'>PopUpTreeMenu:</div>
<span class='toc_search'>Filter: <input id='toc_search'></span><ul class='toc'><li class='toc1'><a href='#description'>Description</a></li>
<ul class='toc'><li class='toc2'><a href='#known%20problems%20/%20todo'>known problems / todo</a></li>
<ul class='toc'></ul></ul><li class='toc1'><a href='#classmethods'>Class methods</a></li>
<ul class='toc'><li class='toc2'><a href='#Inherited%20class%20methods'>Inherited class methods</a></li>
<li class='toc2'><a href='#Undocumented%20class%20methods'>Undocumented class methods</a></li>
<ul class='toc'><li class='toc3'><a href='#*new'>new</a> </li>
</ul></ul><li class='toc1'><a href='#instancemethods'>Instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-tree'>tree</a> </li>
<li class='toc3'><a href='#-value'>value</a> </li>
<li class='toc3'><a href='#-currentLeaf'>currentLeaf</a> </li>
<li class='toc3'><a href='#-action'>action</a> </li>
<li class='toc3'><a href='#-openAction'>openAction</a> </li>
<li class='toc3'><a href='#-closeAction'>closeAction</a> </li>
<li class='toc3'><a href='#-sortFunc'>sortFunc</a> </li>
<li class='toc3'><a href='#-currentPath'>currentPath</a> </li>
<li class='toc3'><a href='#-value'>value</a> </li>
<li class='toc3'><a href='#-valueAction'>valueAction</a> </li>
<li class='toc2'><a href='#Inherited%20instance%20methods'>Inherited instance methods</a></li>
<li class='toc2'><a href='#Undocumented%20instance%20methods'>Undocumented instance methods</a></li>
<ul class='toc'><li class='toc3'><a href='#-bounds'>bounds</a> </li>
<li class='toc3'><a href='#-font'>font</a> </li>
<li class='toc3'><a href='#-hiliteColor'>hiliteColor</a> </li>
</ul></ul><li class='toc1'><a href='#examples'>Examples</a></li>
<ul class='toc'></ul></ul></div><div id='menubar'></div>
<div class='contents'>
<div class='header'>
<div id='label'>
<span id='folder'>Classes (extension)</span>
 | <span id='categories'><a href='./../Browse.html#GUI'>GUI</a></span>
</div><h1>PopUpTreeMenu<span id='superclasses'> : <a href="../Classes/SCViewHolder.html">SCViewHolder</a> : <a href="../Classes/Object.html">Object</a></span>
<div class='extension-indicator-ctr' title='This help file originates from a third-party quark or plugin for SuperCollider.'><img class='extension-indicator-icon' alt='Extension' src='./../images/plugin.png'><span class='extension-indicator-text'>Extension</span></div></h1>
<div id='summary'>hierarchical PopUp menu</div>
</div>
<div class='subheader'>
<div id='filename'>Source: <a href='file:///home/stefan/.local/share/SuperCollider/downloaded-quarks/PopUpTreeMenu/PopUpTreeMenu.sc' title='/home/stefan/.local/share/SuperCollider/downloaded-quarks/PopUpTreeMenu/PopUpTreeMenu.sc'>PopUpTreeMenu.sc</a></div><div id='related'>See also: <a href="./../Classes/PopUpMenu.html">PopUpMenu</a></div>
</div>
<h2><a class='anchor' name='description'>Description</a></h2>
<h3><a class='anchor' name='known%20problems%20/%20todo'>known problems / todo</a></h3>
<ul>
<li>The tree must must follow the structure described below. Later it might be possible to use e.g. <code>Help.tree</code><li>Screen width and height are not respected. Menus with many entries may be cut off at the borders.<li>Click once and menu should stay open so one can browse without keeping the mouse pressed. This is difficult due to mouseOverAction bug - it does not fire when already clicked somewhere else.<li>SwingOSC: scroll handles appear. difficult to solve - something with font size calculation.</ul>
<div class='note'><span class='notelabel'>NOTE:</span> This quark now requires sc version 3.3.1 or newer.</div><h2><a class='anchor' name='classmethods'>Class Methods</a></h2>
<h3><a class='anchor' name='Inherited%20class%20methods'>Inherited class methods</a></h3>
<div id='inheritedclassmets'></div><h3><a class='anchor' name='Undocumented%20class%20methods'>Undocumented class methods</a></h3>
<h3 class='method-code'><span class='method-prefix'>PopUpTreeMenu.</span><a class='method-name' name='*new' href='./../Overviews/Methods.html#new'>new</a>(<span class='argstr'>parent</span>, <span class='argstr'>bounds</span>)</h3>
<h2><a class='anchor' name='instancemethods'>Instance Methods</a></h2>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-tree' href='./../Overviews/Methods.html#tree'>tree</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-tree' href='./../Overviews/Methods.html#tree'>tree</a> = value</h3>
<div class='method'>
<p>Dictionary of dictionaries. Branches terminate if they have an empty dictionary as a value (= leaf). Everything have to be symbols.<textarea class='editor'>( 'symbol1': (), 'symbol2': () )        //same level
( 'symbol': ( 'symbol': () ) )            //nested
( '1' : ('11': () ), '2.2': ('22': () ) )    //numbers also have to be symbols</textarea>
</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-value' href='./../Overviews/Methods.html#value'>value</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-value' href='./../Overviews/Methods.html#value'>value</a> = <span class='argstr'>path</span></h3>
<div class='method'>
<p>Array of symbols pointing to the last selected node. <code>nil</code> if nothing selected.</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-currentLeaf' href='./../Overviews/Methods.html#currentLeaf'>currentLeaf</a></h3>
<div class='method'>
<p>Array of symbols pointing to current selection (leaves only). Empty if nothing selected. See <a href="#-currentPath">-currentPath</a> for reporting both nodes and leaves.</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-action' href='./../Overviews/Methods.html#action'>action</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-action' href='./../Overviews/Methods.html#action'>action</a> = value</h3>
<div class='method'>
<p>Function that gets evaluated when some leaf is selected. Arguments passed: this, value</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-openAction' href='./../Overviews/Methods.html#openAction'>openAction</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-openAction' href='./../Overviews/Methods.html#openAction'>openAction</a> = value</h3>
<div class='method'>
<p>Function that gets evaluated when the popup menu is clicked. Arguments passed: this, mouseX, mouseY. This can be used to automatically populate the tree to keep it in sync with files in a folder. See <a href="#examples">examples</a> below.</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-closeAction' href='./../Overviews/Methods.html#closeAction'>closeAction</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-closeAction' href='./../Overviews/Methods.html#closeAction'>closeAction</a> = value</h3>
<div class='method'>
<p>Function that gets evaluated when the popup menu closes. Arguments passed: this, mouseX, mouseY.</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-sortFunc' href='./../Overviews/Methods.html#sortFunc'>sortFunc</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-sortFunc' href='./../Overviews/Methods.html#sortFunc'>sortFunc</a> = value</h3>
<div class='method'>
<p>Sorts the dictionary in other ways than in the default alphabetic order.</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-currentPath' href='./../Overviews/Methods.html#currentPath'>currentPath</a></h3>
<div class='method'>
<p>Array of symbols pointing to current selection. Array is empty if nothing selected.</div><h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-value' href='./../Overviews/Methods.html#value'>value</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-value' href='./../Overviews/Methods.html#value'>value</a> = <span class='argstr'>path</span></h3>
<div class='method'>
<p>Set the value.<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>path<td class='argumentdesc'>
<p>Should be an array of symbols.</table></div></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-valueAction' href='./../Overviews/Methods.html#valueAction'>valueAction</a> = <span class='argstr'>path</span></h3>
<div class='method'>
<p>Set the value and evaluate the action.<h4>Arguments:</h4>
<table class='arguments'>
<tr><td class='argumentname'>path<td class='argumentdesc'>
<p>Should be an array of symbols.</table></div><h3><a class='anchor' name='Inherited%20instance%20methods'>Inherited instance methods</a></h3>
<div id='inheritedinstmets'></div><h3><a class='anchor' name='Undocumented%20instance%20methods'>Undocumented instance methods</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-bounds' href='./../Overviews/Methods.html#bounds'>bounds</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-bounds' href='./../Overviews/Methods.html#bounds'>bounds</a> = <span class='argstr'>argRect</span></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-font' href='./../Overviews/Methods.html#font'>font</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-font' href='./../Overviews/Methods.html#font'>font</a> = <span class='argstr'>argFont</span></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-hiliteColor' href='./../Overviews/Methods.html#hiliteColor'>hiliteColor</a></h3>
<h3 class='method-code'><span class='method-prefix'>.</span><a class='method-name' name='-hiliteColor' href='./../Overviews/Methods.html#hiliteColor'>hiliteColor</a> = value</h3>
<h2><a class='anchor' name='examples'>Examples</a></h2>
<textarea class='editor'>//--simple example
(
var w= Window("popuptreemenu - simple", Rect(200, 400, 300, 100)).front;
a= PopUpTreeMenu.new(w, Rect(50, 30, 100, 20))
    .tree_(
        (
            'a drum': (),
            'bass': (
                'funky': (),
                'unhip': (
                    'umpahTuba': (),
                    'umpahUpright': ()
                )
            ),
            'melo': ()
        )
    );
a.action_{|view, val| ("selected:"+val).postln};
)
a.value_(['bass', 'funky'])
a.value_(['melo'])
a.valueAction_(['bass', 'unhip', 'umpahTuba'])


//--polling state of the menu in use - example also show custom color/font settings
(
var w= Window("popuptreemenu - state", Rect(400, 400, 300, 100)).front;
a= PopUpTreeMenu.new(w, Rect(10, 20, 200, 34))
    .tree_(('aaa': (), 'bbb': (), 'ccc': ('123': (), '456': (), '789': ('hier': ()))))
    .font_(Font("Arial", 24))
    .background_(Color.red(1))
    .hiliteColor_(Color.red(0.75))
    .stringColor_(Color.red(0.5));
Routine({while({w.isClosed.not}, {
    ("path:"++a.currentPath).post;
    (" leaf:"++a.currentLeaf).post;
    (" value:"++a.value).postln;
    0.4.wait;
})}).play(AppClock);
)
//--changing position and font while active
a.value_(['aaa'])
a.bounds_(Rect(30, 30, 100, 20));
a.font_(Font("Geneva", 10));
a.refresh
a.value;
a.sortFunc= {|a, b| a&gt;b}
a.sortFunc= nil            //the default
//cmd period to stop


//--scanning a folder each time menu is pressed.
//--slightly inefficient but keeps menu/folder in sync
(
var root= "~/Music".standardizePath;    //edit this!
var w= Window("popuptreemenu - scan", Rect(200, 400, 300, 100)).front;
var buildTreeFunc;
a= PopUpTreeMenu.new(w, Rect(10, 20, 200, 20)).items_([root.basename]);
buildTreeFunc= {|path|
    var deepPathMatch, syms, tree;
    var dir= path.dirname;
    deepPathMatch= {|pn|
        var arr= [];
        pn.pathMatch.do{|x|
            if(x.last.isPathSeparator, {
                arr= arr++deepPathMatch.value(PathName(x++"*"));
            }, {
                arr= arr++PathName(x);
            })
        };
        arr
    };
    syms= deepPathMatch.value(PathName(path)).collect{|x|
        var pathNoRoot= x.fullPath.copyToEnd(root.size);
        pathNoRoot.split($/).collect{|y| y.asSymbol}
    };
    tree= ();
    syms.do{|x|
        var parent= tree;
        x.do{|y, i|
            var node= parent[y];
            if(node.isNil, {
                parent.put(y, ());
                parent= parent[y];
            }, {
                parent= node;
            });
        };
    };
    tree;
};
a.openAction_{|view, x, y|
    ("rebuilding tree of"+root).postln;
    view.tree= buildTreeFunc.value(root); //build and replace tree
};
a.closeAction_{|view, x, y| "closing".postln};
a.action_{|view, val| ("selected:"+root++val.join($/)).postln};
)</textarea>

<p><div class='doclink'>helpfile source: <a href='file:///home/stefan/.local/share/SuperCollider/downloaded-quarks/PopUpTreeMenu/HelpSource/Classes/PopUpTreeMenu.schelp'>/home/stefan/.local/share/SuperCollider/downloaded-quarks/PopUpTreeMenu/HelpSource/Classes/PopUpTreeMenu.schelp</a><br>link::Classes/PopUpTreeMenu::<br></div></div><script src='./../editor.js' type='text/javascript'></script>
</body></html>